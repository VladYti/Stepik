#Конструкция Пэли и коды Боуза-Шриханде

Реализуйте алгоритм построения кодов Боуза-Шриханде второго типа, которые построены по матрице Адамара, построенной в свою очередь на основе конструкции Пэли. На вход программы подаётся единственное целое число п. Гарантируется, что и делится на 4 без остатка, и что (n - 1) — простое число. Программа должна выдать 2n строчек длины п, содержащих нули и единицы. Строчки должны быть все различны, причём количество различных позиций в любой паре различных строчек должно быть не менее п/2.
Вычислительной оптимальности не требуется, но полезно, например, предвычислить таблицу значений символа Лежандра.
Sample Input 1:
Sample Output 1:
0000
0011
0101
0110
1001
1010
1100
1111
